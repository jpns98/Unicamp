\documentclass{article}
%\documentclass[12pt,openany]{book}
%\documentclass[a4paper,11pt,openany]{article}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}


%----------------------------------------------------------------------------------------
\usepackage{subfigure}
\usepackage{verbatim} %comentários em bloco

\usepackage[framed,numbered,autolinebreaks,useliterate,final]{mcode}
\usepackage[boxruled, plain, linesnumbered, portuguese]{algorithm2e}

\usepackage{hyperref}
\hypersetup{
    colorlinks=false,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,}
\urlstyle{same}
%----------------------------------------------------------------------------------------

%\usepackage{geometry}
%\geometry{a4paper, left=3cm, right=2cm, top=3cm, bottom=2cm}

%\usepackage{abntex2cite}
\usepackage[T1]{fontenc}%acentuação
%\usepackage{calligra}
\usepackage{setspace}
\usepackage{epsfig} % para incluir figuras .eps
\usepackage{color} % As figuras do xfig precisam\cdots
\usepackage{multicol}
\usepackage{amsmath,amsthm,amsfonts,amssymb}
\usepackage{mathabx}
\usepackage[mathcal]{eucal}
\usepackage{latexsym}
\usepackage[brazil]{babel}
\usepackage{fancyhdr} % para rodapés e cabeçalhos
%\usepackage[latin1]{inputenc}
\usepackage{bm}
\usepackage[all]{xy}
\usepackage{graphics}
\usepackage{float} 
\usepackage{epstopdf}
%\usepackage{phonetic}
\usepackage{yhmath}
\usepackage{amssymb}
\usepackage[all]{xy}
\newtheorem{defi}{Definição}[section]
\newtheorem{exem}{Exemplo}[section]
\newtheorem{prop}{Proposição}[section]
\newtheorem{teo}{Teorema}[section]
\newtheorem{cor}{Corolário}[section]
\newtheorem{lema}{Lema}[section]
\newtheorem{obs}{Observação}[section]
\newtheorem{exercise}{Exercício}
\newcommand{\X}{X_{x,\gamma}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\K}{\mathbb{K}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\id}{\mathbf{1}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\V}{{\cal V}} 
\newcommand{\tm}{\displaystyle {\dfrac{1}{n} \sum _{j=0} ^{n-1} {\varphi (f^j(x))}}}
\newcommand{\lm}{\displaystyle{\lim_{n \rightarrow \infty}}}
\usepackage{enumerate}
\usepackage[top=3cm, bottom= 3cm,left=2.5cm,right=2.5cm]{geometry}


\newcommand{\ok}{\textcolor{red}{$\checkmark$}}

\newcommand{\aqui}{\textcolor{red}{CORRIGIR ESSA PORRA}}

\newcommand{\zx}{\textcolor{red}{CORRIGIR ESSA PORRA}}



\newtheorem{theorem}{Teorema}

\theoremstyle{definition}
\newtheorem{definition}{Definição}

\newtheorem{lem}{Lema}
\newtheorem{proposition}{Proposição}
\newtheorem{corollary}{Corolário}

\newtheorem{observation}{Observação}

\newtheorem{example}{Exemplo}
\newtheorem{axiom}{Axioma}
\title{Atividade 2}
\author{Turma de MT623A e MS712A}
\date{19 de Abril de 2021}
\begin{document}

\begin{titlepage}
\maketitle
\vspace{7cm}

\begin{center}



{\large UNIVERSIDADE ESTADUAL DE CAMPINAS}\\{\large INSTITUTO DE MATEMÁTICA, ESTATÍSTICA E COMPUTAÇÃO CIENTÍFICA}\\




\vspace{7cm}

{\sf \large {\bf Autores}: \\
Fábio Henrique de Carvalho\\
João Pedro do Nascimento Sandolin RA:176146\\
Martha Aurora Parra Pulido. RA: 211681\\
Victor Lohan dos Santos Araujo. RA: 233745}

\vspace{0.6cm}


\end{center}

\end{titlepage}
\newpage
\tableofcontents
\thispagestyle{empty}
\newpage
\section{Formulação do Problema}

O objetivo é estudar os seguintes problemas:
\begin{itemize}
    \item[i)] Aproximar soluções de 
    \begin{align}
    \begin{cases}
    -u'' + u = x \ \ \ \ \forall \ x \in \Omega = (0,1)\\
    u(0) = u(1) = 0.
    \end{cases}\label{prob1}
\end{align}
\item[ii)]Minimizar o funcional $J_1$ dado por
\begin{equation}\label{prob2}
    J_1[v] = \dfrac{1}{2}\displaystyle\int_0^1\alpha(v')^2 + \beta v^2 dx - \displaystyle\int_0^1 v dx,
\end{equation}
com $\alpha>0$ e $\beta  \ge 0$.
\item[iii)] Minimizar o funcional $J$ dado por 
\begin{equation}
    J[v] = \dfrac{1}{2}\displaystyle\int_\Omega(\alpha|\nabla v|^2 + \gamma v^2) d\Omega - \displaystyle\int_\Omega fv d\Omega - \displaystyle\int_{\Gamma_N}gvd\Gamma \label{func1}
\end{equation}
com $\alpha >0$ e $\gamma \ge 0$.
\item[iv)] Aproximar soluções do problema
\begin{align}
-\Delta(u) + u = (2\pi^2+ 1) \sin(\pi x)\sin(\pi y)\quad\text{em}\quad \Omega = (0, 1) \times (0, 1)
\end{align}
\begin{align*}
u=0 \quad\text{sobre}\quad\partial\Omega
\end{align*}
\end{itemize}
Para fazer essas análises iremos discutir os espaços adequados e quais métodos iremos utilizar.
\section{Espaços $H^1(\Omega)$ e $H_0^1(\Omega)$}
As demonstrações omitidas nesse capítulo podem ser encontradas em \cite{Textoprincipal}.
\subsection{Caso $\Omega = (0,1)$}
Multiplicando a EDO do problema (1) por uma função $v$ qualquer de classe $C^1(0,1)$ e integrando por partes, temos a formulação variacional
\begin{equation*}
    \displaystyle\int_0^1u'v'dx - u'v\big{|}_0^1 + \displaystyle\int_0^1uvdx = \displaystyle\int_0^1xv(x)dx.
\end{equation*}
Analisando o problema (1), vemos que o comportamento de $u$ na fronteira está definido, então não perdemos informação se supormos que a função $v$ se anula no bordo de $\Omega$. Iremos definir a classe de funções $v$ que estamos interessados em analisar.
\begin{definition}
$H_0^1(\Omega)$(segundo Odem) é o conjunto das funções deriváveis, tais que
\begin{equation*}
    \displaystyle\int_0^1(v')^2dx < \infty
\end{equation*}
e $v(0) = v(1) = 0$.
\end{definition}

Então definimos como \textit{Solução fraca} ou \textit{Solução generalizada} de (1), uma função $u$ tal que
\begin{equation*}
     \displaystyle\int_0^1u'v'dx + \displaystyle\int_0^1uvdx = \displaystyle\int_0^1xvdx
\end{equation*}
para toda $v \in H_0^1(\Omega)$.

Aqui iremos fazer alguns comentários sobre os espaços que iremos trabalhar. Em livros de análise funcional, os espaços $H_0^1$ são definidos de outro modo, aqui iremos mostrar que essas definições são equivalentes. Iremos utilizar algumas noções básicas de análise funcional e tentar deixar as definições as mais claras possíveis para podermos trabalhar com classes maiores de funções. 

\begin{definition}
Definimos $D(0,1)$ o conjunto das funções $v$ infinitamente diferenciáveis que se anulam fora de um intervalo fechado $[a,b] \subset (0,1)$, onde o intervalo $[a,b]$ depende de cada função. 
\end{definition}

Agora podemos falar do conceito de derivada fraca. Seja $f$ uma função quadrado integrável. Dizemos que $g$ é a \textit{derivada fraca} de $f$, se
\begin{equation*}
    \displaystyle\int_0^1fv'dx = -\displaystyle\int gvdx
\end{equation*}
para toda $v \in D(0,1)$. O conjunto das funções $f:(0,1) \rightarrow \R$ quadrado integráveis, fracamente deriváveis com derivada quadrado integrável munido da norma
\begin{equation*}
    ||u||_{H^1(\Omega)} =\left( \displaystyle\int_0^1|g|^2dx + \displaystyle\int_0^1|u|^2dx\right)^{1/2}
\end{equation*}
é chamado \textit{Espaço de Sobolev de índice 1} e é denotado por $H^1(0,1)$. Note que aqui se $u \in H^1(0,1)$ não necessariamente temos que $u(0) = u(1) = 0$. Para isso basta notar que a função $f(x) = x +1$ está em $H^1(0,1)$, mas não se anula em nenhum ponto de $(0,1)$. Para isso criamos um novo espaço. 
\begin{definition}
O espaço $H_0^1(0,1)$ é o fecho de $D(0,1)$ em $H^1(0,1)$, ou seja, $u \in H_0^1((0,1))$ se existe uma sequência de funções $(\psi_n)$ em $D(0,1)$ tal que 
\begin{equation*}
    \displaystyle\lim_{n\rightarrow\infty}||u - \psi_n||_{H_0^1(\Omega)} = 0
\end{equation*}
\end{definition}

Assim, no espaço $H_0^1(0,1)$ já temos a propriedade das funções se anularem no bordo. Note que com a definição 3 podemos considerar funções como 
\begin{equation*}
    g(x)=\begin{cases}
    4x-1 \ \ \ \ \ \ \ \text{se} \ \ x \in (0,1/2)\\
    3 - 4x \ \ \ \text{se} \ \ x \in [1/2,1)\\
    0 \ \ \ \ \ \ \text{caso contrário},
    \end{cases}
\end{equation*}
que não são deriváveis no sentido clássico. Um complicador seria ter que sempre construir a sequência de funções $\phi_n$, mas o seguinte resultado, cuja prova pode ser encontrada em [1], caracteriza casos como o da função acima
\begin{theorem}
Se $u \in H^1(\Omega)$ e $u(x) = 0$ para todo $x$ no complementar de um intervalo $[a,b] \subset \Omega$, então $u \in H_0^1(\Omega)$.
\end{theorem}
Note que nas definições 2 e 3 estamos trabalhando apenas no intervalo $(0,1)$, mas nada estamos falando sobre $u$ na fronteira. Esse problema se dá pois a definição só é trabalhada em conjuntos abertos, mas podemos resolver isso estendendo as funções a $[0,1]$ por continuidade, ou seja
\begin{equation*}
    f(0) = \displaystyle\lim_{x\rightarrow 0}f(x) \ \ \ \text{e} \ \ \ f(1) = \displaystyle\lim_{x\rightarrow 1}f(x) 
\end{equation*}
que por abuso de notação iremos chamar também de $f$ a sua extensão ao intervalo $[0,1]$. Feitas essas convenções podemos estabelecer que as definições 1 e 3 de $H_0^1$ são equivalentes desde que se modifique na definição 1 o termo derivável por fracamente derivável. A definição 3 contém a definição 1 então está provado. Para mostrar que a definição 1 implica a definição 3 resta apenas provar que a função $v$ é quadrado integrável. Isso segue de 2 fatos
\begin{itemize}
    \item[i)]As funções $C^{\infty}(0,1)$ que se anulam fora de um fechado contido em $(0,1)$ são densas nas funções integráveis sobre (0,1);
    \item[ii)] Se uma sequência de funções converge para $f$ na norma $L^1(0,1)$ então existe uma subsequência que converge em quase todo ponto.
\end{itemize}
 A prova desses resultados podem ser encontradas em $[2]$ assim ficamos com as seguintes desigualdades
\begin{equation*}
   -\varepsilon\displaystyle\int_0^1vdx + \displaystyle\int_0^1v\psi dx\le \displaystyle\int_0^1v^2dx \le \varepsilon\displaystyle\int_0^1vdx + \displaystyle\int_0^1v\psi dx.
\end{equation*}
logo $v$ é quadrado integrável, o que prova que as definições são equivalentes.


\subsection{Caso $\Omega$ um aberto simplesmente conexo de $\R^n$}
A construção desse espaço é semelhante ao caso $\Omega = (0,1)$, assim precisamos das funções teste para o novo caso.
\begin{definition}
Definimos $D(\Omega)$ o conjunto das funções $v$ infinitamente diferenciáveis que se anulam fora de um um conjunto fechado $F \subset \Omega$, onde o conjunto $F$ depende de cada função. 
\end{definition}
Assim podemos obter o espaço de Sobolev $H^1(\Omega)$ de modo análogo ao caso anterior, mas agora considerando derivadas fracas parciais.
\begin{definition}
O espaço de Sobolev $H^1(\Omega)$ é o conjunto de funções $u$ quadrado integráveis, tais que que existe $g_i$ que satisfaz
\begin{equation*}
    \displaystyle\int_\Omega u\dfrac{\partial v}{\partial x_i}d\Omega = -\displaystyle\int_\Omega g_i v d\Omega \ \ \ \ \forall \ v \in D(\Omega),
\end{equation*}
para cada $i = 1,2,\cdots,n$, equipado com a norma
\begin{equation*}
  ||u||_{H^1(\Omega)} = \left( \displaystyle\int_\Omega \displaystyle\sum_{i=1}^n (g_i)^2 dx + \displaystyle\int_\Omega u^2dx\right)^{1/2}.
\end{equation*}
\end{definition}
\section{Método de Galerkin}
Consideremos o problema da Eq.(\ref{prob1}), isto é, encontrar $u\in H_0^{1}$ tal que
\begin{equation*}
\begin{cases}
- u'' +  u  = x \ \ \text{em} \ \Omega\\
u(0)=u(1)=0,
\end{cases}
\end{equation*}
com solução analítica dada por,
\begin{align*}
    u(x)= x - \frac{\sinh{x}}{\sinh{(1)}}
\end{align*}
Iremos motivar o método utilizando o problema (1). Como as funções de $H_0^1(\Omega)$ se anulam no bordo, então a nossa formulação variacional se torna: encontrar uma função $u$ tal que 
\begin{equation}
    \displaystyle\int_0^1u'v'dx + \displaystyle\int_0^1uvdx = \displaystyle\int_0^1xvdx.
\end{equation}
para toda $v \in H_0^1(\Omega)$.
Seja  $\mathcal{V}_h=\{\phi_1,\phi_2,\cdots,\phi_n\}\subset H_0^1$. Nossa primeira simplificação no problema variacional é determinar $u$ tal que
\begin{equation}
    \displaystyle\int_0^1u'v'dx + \displaystyle\int_0^1uvdx = \displaystyle\int_0^1xvdx.
\end{equation}
para toda $v \in\mathcal{V}_h$. Além disso, iremos procurar $u$ como combinação linear de $\mathcal{V}_h$, logo
\begin{align*}
u_h=\sum_{k=1}^{n}\alpha_k\phi_k.
\end{align*}
 Nosso problema passa a ser determinar os coeficientes $\alpha_k$. Note que,
\begin{align*}
 &-\int_{0}^{1} u_h'\phi_i dx +\int_{0}^{1}  u_h\phi_i dx= \int_{0}^{1} x\phi_i dx,
\end{align*}
para $i =1,2,\cdots, n$, então
\begin{equation*}
    \int_{0}^{1}  \left(\sum_{j=1}^{n}\alpha_j\phi_j\right)' \phi_i'dx+\int_{0}^{1} \sum_{j=1}^{n}\alpha_j\phi_j\phi_i dx= \int_{0}^{1} x\sum_{i=1}^{n}\beta_i\phi_i dx
\end{equation*}

Assim, obtemos um sistema $K\alpha=F$, onde $K$ é denotado por \textit{matriz de rigidez} e $F$ é o termo de fonte. Note que,
\begin{align*}
K_{ij}=\int_{0}^{1} \left( \left(\phi_j\right)' \left(\phi_i\right)'+\phi_j\phi_i \right) dx,\quad\text{e}\quad
F_i=\int_{0}^{1} x\phi_i dx.
\end{align*}



\begin{observation}
Apesar de a primeiro momento parecer muito restritiva a condição de procurarmos $u$ como combinação linear de funções de $H_0^1(\Omega)$, essa escolha é perfeitamente natural, pois $H_0^1(\Omega)$ é um espaço \textit{separável}, ou seja, existe um subconjunto enumeravel $U$ de $H_0^1(\Omega)$ denso, equivalentemente, para qualquer $u \in H_0^1(\Omega)$ temos
\begin{equation*}
    u =  \displaystyle\lim g_n \ \ \ \text{na norma} \ H^1(\Omega)
\end{equation*}
onde $g_n \in U$ para todo $n$. Além disso, essas funções podem ser tomadas de classe $C^{\infty}$, o que justifica as aproximações do método mesmo tomando funções bem particulares como por exemplo polinômios, que são densos nas funções contínuas e estas são densas em $H_0^1$.
\end{observation}
A depender da escolha do nosso conjunto podemos ter aproximações melhores ou piores. Essa escolha reflete diretamente no condicionamento da matriz. 
\begin{example}
Para o caso onde $\phi_i = x^i(x-1)$, no problema \ref{prob}, temos 
\begin{align*}
    K_{ij} = \displaystyle\int_0^1[(i+1)x^i - ix^{i-1}][(j+1)x^j - jx^{j-1}] + [x^{i}(x-1)][x^j(x-1)] dx.
\end{align*}
Calcularemos separadamente cada uma das duas somas na integral que iremos denotar $I_1$ e $I_2$ respectivamente, assim
\begin{align*}
    I_1 &= \displaystyle\int_0^1 (i+1)(j+1)x^{i+j} - (i+1)jx^{i+j-1} - i(j+1)x^{j+i-1} + ijx^{i + j -2}dx\\
    &=\dfrac{(i+1)(j+1)}{i+j +1} - \dfrac{(i+1)j}{i+j}  - \dfrac{i(j+1)}{j+i} + \dfrac{ij}{i+j-1}\\
    &= \dfrac{(i+1)(j+1)}{i+j +1} - \dfrac{(i+1)j + i(j+1)}{i+j}   + \dfrac{ij}{i+j-1}
\end{align*}
e
\begin{align*}
    I_2 &= \displaystyle\int_0^1 x^{i+j+2} - 2x^{i+j+1} + x^{i+j}\\
    &= \dfrac{1}{i+j+3} - \dfrac{2}{i+j+2} + \dfrac{1}{i + j +1}.
\end{align*}
Assim,
\begin{equation*}
    K_{ij} = \dfrac{1 + (i+1)(j+1)}{i+j +1} - \dfrac{(i+1)j + i(j+1)}{i+j}   + \dfrac{ij}{i+j-1} + \dfrac{1}{i+j+3} - \dfrac{2}{i+j+2}.
\end{equation*}
E $F_i$ é dado por
\begin{align*}
    F_i &= \displaystyle\int_0^1 x^{i+1}(x-1) dx\\
    &= \displaystyle\int_0^1 x^{i+2} - x^{i+1}dx\\
    &= \dfrac{1}{i+3} - \dfrac{1}{i+2}
\end{align*}
\end{example}

\section{Método de Galerkin em $\R^n$}
Aqui iremos considerar $\Omega$ um conjunto simplesmente conexo com bordo suave. Consideremos o problema, encontrar $u\in\mathcal{U}=\{u\in H^1\quad\text{tal que} \quad u=0 \quad \text{sobre}\quad \partial\Omega \}$ tal que
\begin{equation}
\begin{cases}
- \Delta u +  u  = f \ \ \text{em} \ \Omega\\
u=0 \quad\text{sobre}\quad\partial\Omega.
\end{cases}
\end{equation}
Multiplicando a equação (7) por uma função de $\mathcal{U}$ de classe $C^1$ e aplicando o teorema de Green, temos a formulação variacional 
\begin{equation*}
    \int_\Omega \nabla (u)\cdot\nabla (v)d\Omega +\int_\Omega  uv d\Omega= \int_\Omega fv d\Omega,\quad v\in \mathcal{U}
\end{equation*}
Iremos fazer uma simplificação no método variacional. Seja $\mathcal{V}_h=\{\phi_1,\phi_2,\cdots,\phi_n\}\subset \mathcal{U}$, assim procuramos $u$ tal que
\begin{equation*}
    \int_\Omega \nabla (u)\cdot\nabla (v)d\Omega +\int_\Omega  uv d\Omega= \int_\Omega fv d\Omega,\quad v\in \mathcal{V}_h.
\end{equation*}
Agora suponha que $u$ é combinação linear de elementos de $\mathcal{V}_h$, assim queremos encontrar $u_h$ dada por
\begin{equation*}
    u_h = \sum_{j=1}^{n}\alpha_j\phi_j.
\end{equation*}
Assim, nosso problema se reduz a encontrar os coeficientes $\alpha_j$. Note que
\begin{align*}
 &\int_\Omega \nabla (u_h)\cdot\nabla (v_h)d\Omega +\int_\Omega  u_hv_h d\Omega= \int_\Omega fv_h d\Omega,\quad v_h\in \mathcal{V}_h,
 \end{align*}
 ou seja,
 \begin{align*}
\int_\Omega \nabla \left(\sum_{j=1}^{n}\alpha_j\phi_j\right)\cdot\nabla \phi_id\Omega+\int_\Omega  \sum_{j=1}^{n}\alpha_j\phi_j\phi_i d\Omega= \int_\Omega f\phi_i d\Omega,
\end{align*}
para $i = 1,2,\cdots, n$.
Assim, obtemos um sistema $K\alpha=F$, onde $K$ é a matriz de rigidez e $F$ é o termo de fonte e
\begin{align*}
K_{ij}=\int_\Omega \left(\nabla \left(\phi_j(\textbf{x})\right)\cdot\nabla \left(\phi_i(\textbf{x})\right)+\phi_j(\textbf{x})\phi_i(\textbf{x}) \right) d\Omega,\quad\text{e}\quad
F_i=\int_\Omega f\phi_i(\textbf{x}) d\Omega.
\end{align*}
\newpage

\section{Resultados e discussões}
\subsection{Exercício 3, lista 2}
\begin{exercise}[3 lista 2]
Escreva um programa que utilize integração numérica pelo método dos
trapézios compostos, para montar a matriz A e o vetor f, resolva o sistema (4), encontre
o vetor de coordenadas w e determine a solução do Método de Galerkin, equação (3). O
programa deverá ser capaz de usar como funções base tanto $\phi_i = x^i(x-1)$ quanto
$\phi_i = \sin(i\pi x)$.\\
\begin{itemize}
    \item[a)] Compare as coordenadas obtidas na letra a) do Exercício 1 com as obtidas pelo
programa desenvolvido neste exercício para n = 6 e utilizando 5 intervalos para a
integração numérica. A matriz A obtida numericamente é diagonal? Os valores
da diagonal são os esperados? Quais as possíveis causas da diferença? É possível
identificar algum erro apenas analisando as coordenadas?
\item[b)]Compare as coordenadas obtidas pelo programa da letra b) do Exercício 1 com o
programa desenvolvido neste exercício para n = 10 e utilizando 100 intervalos para
a integração numérica. Quais as possíveis causas da diferença?
\end{itemize}
\end{exercise}
\textbf{SOLUÇÃO}\\
\begin{itemize}
\item [a)] Calculamos explicitamente os coeficientes no exemplo 1. As matrizes de rigidez encontradas numericamente foram:
Para a base polinomial
\begin{align*}
	\begin{pmatrix}
	0.39328 & 0.19664 & 0.135712 & 0.10528 & 0.0901972 & 0.0828531\\
	0.19664 & 0.168992 & 0.138528 & 0.118613 & 0.106405 & 0.0990774\\
	0.135712 & 0.138528 & 0.128085 & 0.118181 & 0.110757 & 0.1056\\
	0.105248 & 0.118613 & 0.118181 & 0.11465 & 0.110986 & 0.107953\\
	0.0901972 & 0.106405 & 0.110757 & 0.110986 & 0.10988 & 0.108471\\
	0.0828531 & 0.0990774 & 0.1056 & 0.107953 & 0.108471 & 0.10819\\
	\end{pmatrix}.
	\end{align*}
Para a base senoidal	
	\begin{align*}
   -1 \begin{pmatrix}
    -5.4348 & 1.77636\times 10^{-16} & 7.10543\times 10^{-16} & 0 & 0 & 0\\
    1.77636\times 10^{-16} & -20.2392 & 0 & 2.84217\times 10^{-15} & 0 & 2.84217\times 10^{-15}\\
    7.10543\times 10^{-16} & 0 & -44.9132 & 0 & 5.68434\times 10^{-15} & 1.42109\times 10^{-15}\\
    0 & 2.84217\times 10^{-15} & 0 & -79.4568 & 0 & - 117.935\\
    0 & 0 & 5.68434\times 10^{-15}& 0 & -246.74 & 0\\
    0 &  2.84217\times 10^{-15} & 1.42109\times 10^{-15} & -117.935 & 0 & -178.153
    \end{pmatrix}.
\end{align*}
\newline
A matriz da base polinomial, mesmo calculada analiticamente, não seria diagonal. Este resultado é esperado devido à utilização de funções não ortogonais para a composição da base do subespaço ${V}_h$ e, consequentemente, para a construção da matriz de rigidez. Vamos analizar algumas normas
\begin{align*}
||A-A_t ||_{L^2}=0.268294  \ \ \ ||A-A_t ||_{\infty}=0.333787\\
||f-f_t ||_{L^2}=0.00786904 \ \ \ ||f-f_t ||_{L^2}=0.00333333
\end{align*}
Estas normas da diferença entre as matrizes de rigidez e fonte obtidas pelo exercício 1a) ($A_t$ e $f_t$) e as matrizes obtidas pelo programa ($A$ e $F$) mostram que, apesar de próximas, o erro introduzido pela integração numérica impede que sejam iguais e o mal condicionamento da matriz de rigidez do programa resulta em erros significativos na resolução do problema.
Diferente da base polinomial, a matriz A para a base senoidal deve ser diagonal, uma vez que utilizamos funções ortogonais para compor a base do subespaço ${V}_h$ e construir a matriz A. Porém, não foi obtida uma matriz diagonal no programa devido aos erros introduzidos pela integração numérica via regra dos trapézios compostos.

	 Os valores da diagonal tem um comportamento inesperado nos últimos valores, visto que a ordem de grandeza sempre depende de $(i\pi)^2 $ então era para serem crescentes, o que não ocorre nos dois últimos. Uma possível causa para essa diferença é o erro numérico do método dos trapézios para realizar a integração, visto que os termos que não são da diagonal deveriam ser nulos, assim fica evidente que o método de integração que usamos tem um erro muito alto. Basta olhar a entrada (4,6) da matriz. Deveria ser nula, mas a integração numérica resultou em 117.935. Essas flutuações nos dão picos inesperados na solução, como podemos observar nos gráficos abaixo
	
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{L2 3a) BP n6 5I IN.jpg}
		\caption{Gráfico para o caso $n= 6$ com 5 intervalos de integração, base polinomial}
	\end{figure}
	
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{L2 3a) BS N6 5I IN.jpg}
		\caption{Gráfico para o caso $n= 6$ com 5 intervalos de integração, base senoidal}
	\end{figure}
\newpage
\item [b)] Podemos ver nos gráficos abaixo que a precisão aumentou absurdamente. Isso por que utilizamos um refinamento bem maior na integração. Assim a matriz muito próxima da feita por integração analítica.
\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{L2 3b) BP N10 100I IN.jpg}
		\caption{Gráfico para o caso $n= 10$ com 100 intervalos de integração, base polinomial}
	\end{figure}
	
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{L2 3b) BS N10 100I IN.jpg}
		\caption{Gráfico para o caso $n= 10$ com 100 intervalos de integração, base senoidal}
	\end{figure}
\end{itemize}
\newpage
\subsection{Exercício 1, lista 3}
\begin{exercise}[1 lista 3] Seja o seguinte problema de minimização de um funcional quadrático:
\begin{itemize}
    \item[Caso I.]
\textbf{Problema N:} Encontrar $u \in \mathcal{U} = \{u \in C^2(0,1);u(0)=u(1)=0\}$ tal que
\begin{equation*}
    J[u] \le J[v] \ \forall \ v\in \mathcal{U} 
\end{equation*}
onde,
\begin{equation}
    J[v] = \dfrac{1}{2}\displaystyle\int_0^1\alpha(v')^2 + \gamma v^2 dx - \displaystyle\int_0^1 v dx,\label{func2}
\end{equation}
com $\alpha>0$ e $\beta  \ge 0$.
\begin{itemize}
    \item [a)] Determine a formulação variacional relativa à condição de variação nula do funcional
quadrático dado pela Eq.(\ref{func2}).
\item[b)] Mostre que para qualquer variação admissível $w$, 
\begin{align*}
 J(u + w) \geq J(u).   
\end{align*} 
\item[c).] Encontre a equação de Euler-Lagrange referente ao Problema N e determine sua solução analítica.
\end{itemize}
\end{itemize}
\end{exercise}
\textbf{SOLUÇÃO}\\
\begin{itemize}
    \item [a)] Para encontrar formulação variacional relativa à condição de variação nula do funcional quadrático dado pela Eq.(\ref{func2}) procederemos da seguinte forma:
	\begin{itemize}
		\item [i.] Sejam $\mathcal{V}=\mathcal{U}$, $u,v\in \mathcal{V}$ e $\varepsilon\in\mathbb{R}$. Calculemos $T(\varepsilon) =J[u + \varepsilon v]$,
		\begin{align*}
		T(\varepsilon) =&J[u + \varepsilon v]=\dfrac{1}{2}\displaystyle\int_{0}^{1}(\alpha(u + \varepsilon v)'(u + \varepsilon v)' + \gamma (u + \varepsilon v)^2) dx
		- \displaystyle\int_{0}^{1} (u + \varepsilon v) dx\\
		=&\dfrac{1}{2}\displaystyle\int_{0}^{1}\alpha(u'u'+\varepsilon u'v'+\varepsilon v'u'+\varepsilon^2 v'v')dx+\dfrac{1}{2}\displaystyle\int_{0}^{1} \gamma (u^2+2\varepsilon u v +\varepsilon^2 v^2) dx - \displaystyle\int_{0}^{1} udx -\int_{0}^{1} \varepsilon v dx.
		\end{align*}
		\item [ii.] Calculemos agora $T'(\varepsilon)$,
		\begin{align*}
		T'(\varepsilon)=&\dfrac{1}{2}\displaystyle\int_{0}^{1}\alpha(2 u'v'+2\varepsilon v'v')dx+\dfrac{1}{2}\displaystyle\int_{0}^{1} \gamma (2 u v +2\varepsilon v^2) dx-\int_{0}^{1} v dx\\
		=&\displaystyle\int_{0}^{1}\alpha( u'v'+\varepsilon v'v')dx+\displaystyle\int_{0}^{1} \gamma ( u v +\varepsilon v^2) dx-\int_{0}^{1} v dx.\\
		\end{align*}
		\item [iii.] Avaliemos a derivada de $T(\varepsilon)$ em $\varepsilon=0$,
		\begin{align*}
		T'(0)=&\displaystyle\int_{0}^{1}\alpha u'v'dx+\displaystyle\int_{0}^{1} \gamma  u v dx-\int_{0}^{1} v dx.
		\end{align*}
		\item [iv.] Para obter a formulação variacional esperada, basta notar que $0$ é ponto crítico da função $T$, logo $T'(0)=0$. Assim
		\begin{align*}
		\int_{0}^{1}\alpha u'v'dx+\displaystyle\int_{0}^{1} \gamma  u v dx-\int_{0}^{1} v dx=0
		\end{align*}
	\end{itemize}
De modo que $u\in\mathcal{U}$ que minimiza o funcional quadrático da Eq.(\ref{func2}) é o mesmo $u$ que satisfaz a forma variacional,
\begin{align*}
		\int_{0}^{1}\alpha u'v'dx+\displaystyle\int_{0}^{1} \gamma  u v dx=\int_{0}^{1} v dx,\quad \forall v\in \mathcal{V},
\end{align*}
ou equivalentemente,
\begin{align*}
\int_{0}^{1}(\alpha u'v'dx+ \gamma  u v) dx=\int_{0}^{1} v dx,\quad \forall v\in \mathcal{V}.
\end{align*}
\item[b).] Note que se $u$ é solução da formulação variacional, então para toda $w \in \mathcal{V}$
\begin{align*}
    J[ u + w] &= J[u] + \dfrac{1}{2}\displaystyle\int_0^1\alpha(w')^2 + \gamma w^2 dx - \displaystyle\int_0^1 w dx + \displaystyle\int_0^1 \alpha u'w' + \gamma uw dx \\
    &= J[u] + \dfrac{1}{2} \displaystyle\int_0^1\alpha(w')^2 + \gamma w^2 dx \ge J[u]
\end{align*}
e $J[u + w] = J[u] \iff w = 0$ em quase todo ponto.
\item[c).] Seguindo a formulação variacional obtida no item a), lembrando que $v\in\mathcal{V}$ e usando a integração por partes,
\begin{align*}
    &-\int_{0}^{1}u''vdx=\int_{0}^{1}u'v'dx-(u'(1)v(1)-u'(0)v(0))=\int_{0}^{1}u'v'dx,
\end{align*}
de modo que,
\begin{align*}
 &\int_{0}^{1}\alpha u'v'dx+\displaystyle\int_{0}^{1} \gamma  u v dx=\int_{0}^{1} v dx,\quad \forall v\in \mathcal{V}.
 \end{align*}
 Como $u$ é de classe $C^2$, temos 
 \begin{align*}
     & -\int_{0}^{1}\alpha u''vdx+\displaystyle\int_{0}^{1} \gamma  u v dx=\int_{0}^{1} v dx,\quad \forall v\in \mathcal{V},
\end{align*}
logo
\begin{align*}
  \int_{0}^{1}(-\alpha u''+\gamma  u - 1)v dx=0,\quad \forall v\in \mathcal{V}.
\end{align*}
Por tanto, a Equação de Euler-Langrange é dada por,
\begin{align*}
-\alpha u''+\gamma  u - 1=0 \quad\text{ou}\quad -\alpha u''+\gamma  u = 1 
\end{align*}
\end{itemize}
Assim,
\begin{equation*}
\begin{cases}
-\alpha u'' + \gamma u  = 1 \\
u(0)=0,\quad u(1)=0.
\end{cases}
\end{equation*}
\newpage
\begin{itemize}
\item[Caso II.]
\end{itemize}
\textbf{Problema M:} Encontrar $u \in \mathcal{U} = \{u \in C^2(0,1);u(0)=1,u(1)=0\}$ tal que
\begin{equation*}
    J[u] \le J[v] \ \forall \ v\in \mathcal{U} 
\end{equation*}
onde,
\begin{equation*}
    J[v] = \dfrac{1}{2}\displaystyle\int_0^1\alpha(v')^2 + \gamma v^2 dx - \displaystyle\int_0^1 v dx,
\end{equation*}
com $\alpha>0$ e $\beta  \ge 0$.\\
Encontre a equação de Euler-Lagrange referente ao Problema M e determine sua solução analítica.\\

\textbf{SOLUÇÃO}\\

Neste caso, para encontrar a equação Euler-Lagrange dado que as condições de Dirichlet não são homogêneas, precisaremos usar a estratégia $u(x)=w(x)+u_d(x)$, onde tomaremos $u_d(x)=1-x$. é importante observar que $w(x)$ deve satisfazer $w(0)=w(1)=0$ e $u_d(0)=1$, $u_d(0)=0$.\\
Seguindo a formulação variacional obtida no Caso I, tomado $\mathcal{V}=\{v\in c^2(0,1)\quad\text{tal que}\quad v(0)=v(1)=0\}$ e substituindo $u$, temos
\begin{align*}
    \int_{0}^{1}\alpha(w+(1-x))'v'dx+\int_{0}^{1}\gamma(w+(1-x))vdx=\int_{0}^{1}vdx.
\end{align*}
Reduzindo o problema a, encontrar $w\in\mathcal{V}$ tal que
\begin{align*}
    \int_{0}^{1}\alpha w''v'dx+\int_{0}^{1}\gamma w vdx=\int_{0}^{1}vdx-\int_{0}^{1}\alpha (1-x)'v'dx-\int_{0}^{1}\gamma (1-x)vdx,
\end{align*}
usando integração por partes e as condições de Dirichlet, temos
\begin{align*}
    \int_{0}^{1}(-\alpha w''v+\gamma w v)dx=\int_{0}^{1}vdx-\int_{0}^{1}\gamma (1-x)vdx,  
\end{align*}
ou equivalentemente,
\begin{align*}
    \int_{0}^{1}(-\alpha w''+\gamma w -1+\gamma (1-x))vdx=0,  
\end{align*}
de modo que, a equação de Euler-Lagrange esta dada por \begin{align*}
  -\alpha w'' + \gamma w = 1 -\gamma(1-x).  
\end{align*}
Assim,
\begin{equation*}
\begin{cases}
-\alpha w'' + \gamma w  = 1-\gamma(1-x) \\
w(0)=0,\quad w(1)=0, 
\end{cases}
\end{equation*}
Com solução analítica dada por
\begin{equation*}
    w_e(x) = \frac{e^{-px}\left(-(\gamma-1)e^{2px}-e^{p(2x+1)}+(\gamma(x-1)+1)e^{p(x+2)}+(\gamma(-x)+\gamma-1)e^{px}+(\gamma-1)e^{2p}+e^p\right)}{\gamma(e^{2p}-1)},
\end{equation*}
onde $p = \sqrt{\dfrac{\gamma}{\alpha}}$,
se $\alpha \neq 0$ e 
\begin{equation*}
    u_e(x) =w_e(x)+(1-x).
\end{equation*}

\newpage
\subsection{Exercício 2, lista 3}
\begin{exercise}[2 da lista 3]Utilize o programa desenvolvido na Lista 2, com bases polinomiais, para
resolver a Equação de Euler-Lagrange da letra c) do Exercício 1. Apresente gráficos
comparativos entre as soluções numéricas e a analítica para os seguintes casos:
\begin{itemize}
    \item[a)] $\alpha =1$,$\gamma = 1$.
    \item[b)] $\alpha = 1\times 10^{-5}$, $\gamma =1$
\end{itemize}
\end{exercise}
\textbf{SOLUÇÃO}\\
\begin{itemize}
    \item [Caso I.]
    Encontrar $u\in \mathcal{V}=\{u \in C^2(0,1);u(0)=u(1)=0\}$ tal que
    \begin{equation*}
\begin{cases}
-\alpha u'' + \gamma u  = 1 \\
u(0)=u(1)=0.
\end{cases}
\end{equation*}
\begin{itemize}
    \item[a)] $\alpha =1$,$\gamma = 1$.\\
        Encontrar $u\in \mathcal{V}$ tal que
    \begin{equation*}
\begin{cases}
-u'' + u  = 1 \\
u(0)=u(1)=0,
\end{cases}
\end{equation*}
com solução analítica dada por:
\begin{align*}
    u_{e}(x)=\frac{-e^{(1-x)}-e^x+1+e}{1-e}
\end{align*}
Comparando os gráficos temos
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2a) n6 5I IN.jpeg}
		\caption{Gráfico para o caso $n= 6$ com 5 intervalos de integração}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2a) n10 100I IN.jpeg}
		\caption{Gráfico para o caso $n= 10$ com 100 intervalos de integração}
	\end{figure}


\item [b)] $\alpha = 1\times 10^{-5}$, $\gamma =1$.\\
    \begin{equation*}
\begin{cases}
-1\times 10^{-5}u'' + u  = 1 \\
u(0)=u(1)=0,
\end{cases}
\end{equation*}
com solução analítica dada por:
\begin{align*}
    u_{e}(x)=\frac{-e^{100\sqrt{10}(x-1)}-e^{100\sqrt{10}x}+1+e^{100\sqrt{10}}}{1+e^{100\sqrt{10}}}
\end{align*}
\end{itemize}
A seguir podemos ver os gráficos comparativos
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2b) n6 5I IN.jpeg}
		\caption{Gráfico para o caso $n= 6$ com 5 intervalos de integração}
	\end{figure}
		\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2b) n10 100I IN.jpeg}
		\caption{Gráfico para o caso $n= 10$ com 100 intervalos de integração}
	\end{figure}
\item[Caso II.] 
Encontrar $w\in \mathcal{V}=\{u \in C^2(0,1);w(0)=0, w(1)=0\}$ tal que
    \begin{equation*}
\begin{cases}
-\alpha w'' + \gamma w  = 1-\gamma(1-x) \\
w(0)=0,\quad w(1)=0, 
\end{cases}
\end{equation*}
onde $u\in\mathcal{U}= \{u \in C^2(0,1);u(0)=1,u(1)=0\}$ é dado por $u(x)=w(x)+(1-x)$
\begin{itemize}
    \item[a)] $\alpha =1$,$\gamma = 1$.\\
        Encontrar $w\in \mathcal{V}$ tal que
    \begin{equation*}
\begin{cases}
-w'' + w  = x \\
w(0)=w(1)=0,
\end{cases}
\end{equation*}
com solução analítica dada por:
\begin{align*}
    w_{e}(x)=x-\frac{\sinh{x}}{\sinh{(1)}},
\end{align*}
assim, 
\begin{align*}
    u_e(x)=x-\frac{\sinh{x}}{\sinh{(1)}}+(1-x)=1-\frac{\sinh{x}}{\sinh{(1)}}
\end{align*}
A seguir temos os graficos comparativo 

	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2a) n6 5I IN NH.jpg}
		\caption{Gráfico para o caso $n= 6$ com 5 intervalos de integração}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2a) n10 100I IN NH.jpg}
		\caption{Gráfico para o caso $n= 10$ com 100 intervalos de integração}
	\end{figure}
\item[b)]  $\alpha = 1\times 10^{-5}$,$\gamma = 1$.\\
        Encontrar $w\in \mathcal{V}$ tal que
    \begin{equation*}
\begin{cases}
-1\times 10^{-5}w'' + w  = x \\
w(0)=w(1)=0,
\end{cases}
\end{equation*}
com solução analítica dada por:
\begin{align*}
    w_{e}(x)=-\frac{e^{-100\sqrt{10}x}\left(e^{100\sqrt{10}x}x-e^{100\sqrt{10}x+200\sqrt{10}}x+e^{200\sqrt{10}x+100\sqrt{10}}-e^{100\sqrt{10}}\right)}{e^{200\sqrt{10}}-1},
\end{align*}
assim, 
\begin{align*}
    u_e(x)=w_e(x)+(1-x).
\end{align*}
\end{itemize}
A seguir os gráficos comparativo
\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2b) n6 5I IN NH.jpg}
		\caption{Gráfico para o caso $n= 6$ com 5 intervalos de integração}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{2b) n10 100I IN NH.jpg}
		\caption{Gráfico para o caso $n= 10$ com 100 intervalos de integração}
	\end{figure}
\end{itemize}

\newpage
\subsection{Exercício 3, lista 3}
\begin{exercise}[Exercício 3 da Lista 3]
Seja agora $\Omega$ um domínio bidimensional, suficientemente regular, com
$\partial\Omega=\Gamma_{D}\cup \Gamma_{N}$, e o seguinte problema de minimização.\\
\textbf{Problema 2D:} Encontrar $u \in \mathcal{U} = \{u \in H^1; u\big{|}_{\Gamma_D} = 0\}$ tal que
\begin{equation*}
    J[u] \le J[v] \ \forall \ v\in \mathcal{U} 
\end{equation*}
onde
\begin{equation}
    J[v] = \dfrac{1}{2}\displaystyle\int_\Omega(\alpha|\nabla v|^2 + \gamma v^2) d\Omega - \displaystyle\int_\Omega fv d\Omega - \displaystyle\int_{\Gamma_N}gvd\Gamma \label{func1}
\end{equation}
com $\alpha >0$ e $\gamma \ge 0$.
\begin{itemize}
	\item [a)] Determine a formulação variacional relativa à condição de variação nula do funcional quadrático dado pela Eq.(\ref{func1}).
	\item [b)] Encontre a equação de Euler-Lagrange referente ao problema 2D e determine a sua forma forte equivalente, incluindo as condições de contorno. 
\end{itemize}
\end{exercise}
\textbf{SOLUÇÃO}
\begin{itemize}
	\item [a)]  Para encontrar formulação variacional relativa à condição de variação nula do funcional quadrático dado pela Eq.(\ref{func1}) procederemos da seguinte forma:
	\begin{itemize}
		\item [i.] Sejam $\mathcal{V}=\mathcal{U}$, $u,v\in \mathcal{V}$ e $\varepsilon\in\mathbb{R}$. Calculemos $T(\varepsilon) =J[u + \varepsilon v]$,
		\begin{align*}
		T(\varepsilon) =&J[u + \varepsilon v]=\dfrac{1}{2}\displaystyle\int_\Omega(\alpha\nabla(u + \varepsilon v)\cdot\nabla(u + \varepsilon v) + \gamma (u + \varepsilon v)^2) d\Omega
		- \displaystyle\int_\Omega f(u + \varepsilon v) d\Omega - \displaystyle\int_{\Gamma_N}g(u + \varepsilon v)d\Gamma\\
		=&\dfrac{1}{2}\displaystyle\int_\Omega\alpha(\nabla(u)\cdot\nabla(u)+\varepsilon\nabla(u)\cdot\nabla(v)+\varepsilon\nabla(v)\cdot\nabla(u)+\varepsilon^2\nabla(v)\cdot\nabla(v))d\Omega\\&+\dfrac{1}{2}\displaystyle\int_\Omega \gamma (u^2+2\varepsilon u v +\varepsilon^2 v^2) d\Omega - \displaystyle\int_\Omega fud\Omega -\int_\Omega \varepsilon fv d\Omega - \displaystyle\int_{\Gamma_N}gu d\Gamma -\int_{\Gamma_N}\varepsilon  g v d\Gamma.
		\end{align*}
		\item [ii.] Calculemos agora $T'(\varepsilon)$,
		\begin{align*}
		T'(\varepsilon)=&\dfrac{1}{2}\displaystyle\int_\Omega\alpha(\nabla(u)\cdot\nabla(v)+\nabla(v)\cdot\nabla(u)+2\varepsilon\nabla(v)\cdot\nabla(v))d\Omega\\
		&+\dfrac{1}{2}\displaystyle\int_\Omega \gamma (2u v +2\varepsilon v^2) d\Omega -\int_\Omega fv d\Omega -\int_{\Gamma_N} g v d\Gamma\\
		=&\int_\Omega\alpha(\nabla(v)\cdot\nabla(u)+\varepsilon\nabla(v)\cdot\nabla(v))d\Omega+\int_\Omega \gamma (u v +\varepsilon v^2) d\Omega -\int_\Omega fv d\Omega -\int_{\Gamma_N} g v d\Gamma.
		\end{align*}
		\item [iii.] Avaliemos a derivada de $T(\varepsilon)$ em $\varepsilon=0$,
		\begin{align*}
		T'(0)=&\int_\Omega\alpha\nabla(v)\cdot\nabla(u)d\Omega+\int_\Omega \gamma u v  d\Omega -\int_\Omega fv d\Omega -\int_{\Gamma_N} g v d\Gamma.
		\end{align*}
		\item [iv.] Para obter a formulação variacional esperada, basta notar que $0$ é ponto crítico da função $T$, logo $T'(0)=0$. Assim
		\begin{align*}
		\int_\Omega\alpha\nabla(v)\cdot\nabla(u)d\Omega+\int_\Omega \gamma u v  d\Omega -\int_\Omega fv d\Omega -\int_{\Gamma_N} g v d\Gamma=0
		\end{align*}
	\end{itemize}
De modo que $u\in\mathcal{U}$ que minimiza o funcional quadrático da Eq.(\ref{func1}) é o mesmo $u$ que satisfaz a forma variacional,
\begin{align*}
\int_\Omega\alpha\nabla(v)\cdot\nabla(u)d\Omega+\int_\Omega \gamma u v  d\Omega =\int_\Omega fv d\Omega +\int_{\Gamma_N} g v d\Gamma,\quad \forall v\in \mathcal{V}
\end{align*}
ou equivalentemente,
\begin{align*}
\int_\Omega(\alpha\nabla(v)\cdot\nabla(u)+ \gamma u v)  d\Omega =\int_\Omega fv d\Omega +\int_{\Gamma_N} g v d\Gamma,\quad \forall v\in \mathcal{V}.
\end{align*}
\item [b)] Para encontrar a equação de Euler-Lagrange, precisaremos usar o teorema de Green, assim impondo $\partial\Omega$ de classe $C^1$, $\Omega $ simplesmente conexo, temos a integral
\begin{align*}
\int_\Omega\nabla(v)\cdot\nabla(u)d\Omega-\int_{\partial\Omega}\nabla(u)\cdot nv  d\Gamma=-\int_\Omega\Delta(u)\cdot vd\Omega,
\end{align*}
assim
\begin{align*}
\int_\Omega\nabla(v)\cdot\nabla(u)d\Omega=-\int_\Omega\Delta(u)\cdot vd\Omega+\int_{\partial\Omega}\nabla(u)\cdot nv  d\Gamma,
\end{align*}
Agora, iremos assumir que $u\in C^2(\Omega)$ e
\begin{equation*}
    \int_{\partial\Omega}\alpha\nabla(u)\cdot nv  d\Gamma =  \int_{\Gamma_N\cup\Gamma_D}\alpha\nabla(u)\cdot nv  d\Gamma = \int_{\Gamma_N} g v d\Gamma=0, \quad \forall v\in \mathcal{V}
\end{equation*}
logo 
\begin{equation*}
    \alpha\nabla(u)\cdot n = g \ \ \text{sobre} \ \ \Gamma_N.
\end{equation*}
Assim, pelo teorema de Green, a formulação variacional tem a forma
\begin{align*}
&-\int_\Omega\alpha\Delta(u)\cdot vd\Omega+\int_\Omega \gamma u v  d\Omega =\int_\Omega fv d\Omega,
\end{align*}
ou seja,
\begin{equation*}
    \displaystyle\int_{\Omega}(-\alpha\Delta(u) +\gamma u -f)vd\Omega = 0,
\end{equation*}
para toda $v \in \mathcal{U}$. Assim, a forma forte (equação de Euler-Lagrange) com condições de contorno dada por,

\begin{equation*}
\begin{cases}
-\alpha \Delta u + \gamma u  = f \ \ \text{em} \ \Omega\\
\alpha\nabla(u)\cdot n = g\ \ \ \text{sobre}\ \Gamma_N\\
\ \ u = 0 \ \ \  \text{sobre} \ \Gamma_D.
\end{cases}
\end{equation*}
\end{itemize}
\begin{observation}[Regularidade de $u$] A priori estamos colocando $u$ de classe $C^2(\Omega)$, mas isso não é completamente necessário. Não provaremos aqui, mas na formulação variacional (5) a regularidade de $u$ já é imposta por $f$ e $g$. Esse fato deve ao operador diferencial equivalente ser um operador elíptico de coeficientes constantes, assim se $f,g \in C^k(\Omega)$ com $k \ge 1$ então $u \in C^k(\Omega)$.
\end{observation}
\newpage
\subsection{Exercício 4, lista 3}
\begin{exercise}(4 da Lista 3)
Seja o problema de valor de contorno: encontrar u tal que
\begin{align*}
-\Delta(u) + u = (2\pi^2+ 1) \sin(\pi x)\sin(\pi y)\quad\text{em}\quad \Omega = (0, 1) \times (0, 1)
\end{align*}
\begin{align*}
u=0 \quad\text{sobre}\quad\partial\Omega
\end{align*}
cuja solução analítica é $u(x) = \sin(\pi x) \sin(\pi y)$.
\begin{itemize}
	\item [a)] Encontre a solução aproximada obtida pelo Método de Galerkin com funções-base\\
	$\phi_1(\textbf{x}) = x(x -1)y(y - 1)$, $\phi_2(\textbf{x}) = x^2(x - 1)y(y - 1)$,
	$\phi_3(\textbf{x}) = x(x - 1)y^2
(y - 1)$ e
$\phi_4(\textbf{x}) = x^2(x - 1)y^2	(y - 1)$ e compare o resultado com a solução analítica.
\item[b)] Repita para o caso de uma única função base, dada por $\phi_1(\textbf{x}) = \sin(\pi x) \sin(\pi y)$.
Discuta o resultado.
\end{itemize}
\end{exercise}
\textbf{SOLUÇÃO}\\
Dado que $\Omega=(0,1)\times(0,1)$, usando o método de Galerkin em $\R^2$, temos que o sistema $K\alpha=F$, é tal que 
\begin{align*}
K_{ij}=\int_{0}^{1}\int_{0}^{1} \left(\nabla \left(\phi_j\right)\cdot\nabla \left(\phi_i\right)+\phi_j\phi_i \right) dx dy,
\end{align*}
e
\begin{align*}
F_j=\displaystyle\int_0^1\int_0^1\left(2\pi^2+1\right)\sin(\pi x)\sin(\pi y)\phi_j dxdy.
\end{align*}
Obtendo,
\begin{equation*}
    K=\begin{pmatrix}
         \frac{7}{300} & \frac{7}{600} & \frac{7}{600} & \frac{7}{1200} \\
         & & & \\
         \frac{7}{600} & \frac{1}{126} & \frac{7}{1200} & \frac{1}{252} \\
         & & & \\
         \frac{7}{600} & \frac{7}{1200} & \frac{1}{126} & \frac{1}{252} \\
         & & &\\
         \frac{7}{1200} & \frac{1}{252} & \frac{1}{252} & \frac{29}{11025}
    \end{pmatrix} \ \ \text{e} \ \  F=\begin{pmatrix}
         \frac{16(2\pi^2+1)}{\pi^6} \\
        &\\
         \frac{8(2\pi^2+1)}{\pi^6} \\
         &\\
         \frac{8(2\pi^2+1)}{\pi^6} \\
         &\\
         \frac{4(2\pi^2+1)}{\pi^6}
    \end{pmatrix}
\end{equation*}
Os gráficos comparativos do item a)
\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{4a) n4 IA.jpg}
		\caption{Gráfico para o caso $n= 4$ com integração analitica}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{4a) n4 CN Analiticas.jpg}
		\caption{Curvas de nível do gráfico anterior}
	\end{figure}
No item $b)$ ocorre o esperado e os gráficos são iguais e se sobrepõem. Isso se dá pois consideramos a única função da base como a solução forte da EDP, assim ela é também solução do problema variacional que usamos para gerar o método de Galerkin.
\begin{figure}[H]
		\centering
		\includegraphics[height=4.5cm]{4b).jpg}
		\caption{Gráfico para o caso $n=1$ com a solução na base e integração analítica}
	\end{figure}
\newpage
\begin{thebibliography}{99}

\bibitem{Textoprincipal}{Medeiros,L.A.; Mirando, M.Milla,} {Espaços de Sobolev: Iniciação aos Problemas Elíticos não Homogêneos, UFRJ, Rio de Janeiro, 2019.}

\bibitem{Tese}{Becker, E.B.; Carey, G.F.; Odem, J.T} {Finite Elements: A introduction, Vol 1, 1981} \\
\end{thebibliography}
\end{document}

